@model InputModel
<table id="TblTeams" class="table table-bordered table-hover table-striped dataTable" role="grid" aria-describedby="searchable_info">
    <thead>
        <tr role="row">
            <th class="wpx50 center" tabindex="0">@Locate.T("STT")</th>
            <th class="wpx120 " tabindex="0" aria-controls="searchable">@Locate.T("Mã phiếu")</th>
            <th class="wauto " tabindex="0" aria-controls="searchable">@Locate.T("Tên tên phiếu")</th>
            <th class="wauto " tabindex="0" aria-controls="searchable">@Locate.T("Tiến độ")</th>
            <th class="wauto " tabindex="0" aria-controls="searchable">@Locate.T("Thời gian")</th>
            <th class="wauto " tabindex="0" aria-controls="searchable">@Locate.T("Ghi chú")</th>
            <th class="wpx120 " tabindex="0" aria-controls="searchable">@Locate.T("Thao tác")</th>
        </tr>
    </thead>
    <tbody>
        @if (Utils.IsNotEmpty(Model.CouponUnitReports))
        {
            var stt = ViewBag.Pagination.RowStart;
            foreach (var item in Model.CouponUnitReports)
            {
                stt++;
                var coupon = Model.Coupons.FirstOrDefault(t => t.ID == item.IDCoupon) ?? new Coupon();

                var alias = Utils.StringAlias(coupon.Name, item.ID);
                var viewLink = Locate.Url("/input-distric/{0}.html", alias);
                var detailLink = Locate.Url("/input-distric/detail/{0}.html", alias);
                var approvedLink = Locate.Url("/input-distric/is-comfirm/{0}.html", alias);
                var rejectLink = Locate.Url("/input-distric/is-reject/{0}.html", alias);
                var unitReport = Model.UnitReports.FirstOrDefault(t => t.ID == item.IDUnitReport) ?? new UnitReport();
                var area = Model.Areas.FirstOrDefault(t => t.ID == item.IDArea) ?? new Area();
                var approveCoupon = ApproveCoupon.Instance.GetListByFieldOrDefault("IDCouponUnitReport", item.ID).FirstOrDefault() ?? new ApproveCoupon();
                var processDate = "";
                if (approveCoupon.ProcessDate.HasValue)
                {
                    processDate = approveCoupon.ProcessDate.Value.ToShortDateString();
                }
                <tr role="row">
                    <td class="center ">@stt</td>
                    <td>@coupon.Code</td>
                    <td>
                        @coupon.Name
                        <span class="clearfix" title="@Locate.T("Đơn vị")">
                            <i class="fa fa-fw fa-hashtag" aria-hidden="true"></i>
                            @Locate.T("Đơn vị") : @unitReport.Name
                        </span>
                    </td>
                    <td>@CUtility.RenderApproveCouponStatus(approveCoupon.Status)</td>
                    <td>@processDate </td>
                    <td>@approveCoupon.Note</td>
                    <td>
                        @if (approveCoupon.Status == (int)DocProUBDT.Customs.Enum.ApproveCouponStatus.DangNhap)
                        {
                            <a class="btn btn-sm btn-blue quickUpdate" data-id="@item.ID" data-target=".ui-dialog:visible" title="@Locate.T("Chờ duyệt")" href="@approvedLink">
                                <i class=""></i> @Locate.T("Chờ duyệt")
                            </a>
                        }
                        @if (approveCoupon.Status == (int)DocProUBDT.Customs.Enum.ApproveCouponStatus.ChoDuyet)
                        {
                            <a class="btn btn-sm btn-blue quickUpdate" data-id="@item.ID" data-target=".ui-dialog:visible" title="@Locate.T("Duyệt")" href="@approvedLink">
                                <i class=""></i> @Locate.T("Duyệt")
                            </a>
                        }
                        @if (approveCoupon.Status == (int)DocProUBDT.Customs.Enum.ApproveCouponStatus.ChoDuyet
                     || approveCoupon.Status == (int)DocProUBDT.Customs.Enum.ApproveCouponStatus.DaDuyet)
                        {
                            <a class="btn btn-sm btn-blue quickUpdate" data-id="@item.ID" data-target=".ui-dialog:visible" title="@Locate.T("Từ chối")" href="@rejectLink">
                                <i class=""></i> @Locate.T("Từ chối")
                            </a>
                        }
                        <form action="/input-distric/detail.html?IDInputGrantReport=@Model.IDInputGrantReport&IDInputUnitReport=@unitReport.ID&IDInputArea=@item.IDArea&IDCoupon=@item.IDCoupon&IDCouponUnitReport=@item.ID" method="post" enctype="multipart/form-data">
                            <button class="btn btn-sm btn-info" type="submit">
                                <i class="glyphicon glyphicon-search"></i>
                                <span class="hidden-search">@Locate.T("Biểu mẫu")</span>
                            </button>
                        </form>
                    </td>
                </tr>
            }
        }
    </tbody>
</table>
<div class="row DTTTFooter">
    @if (ViewBag.Pagination.RowCount == 0)
    {
        <div class="col-sm-12 text-center padt10">
            <strong>
                @Locate.T("Không có giá trị nào phù hợp, vui lòng thử lại")
            </strong>
        </div>
    }
    <div class="col-sm-6">
        <div class="dataTables_info" id="searchable_info" role="status" aria-live="polite"></div>
    </div>
    <div class="col-sm-6">@ViewBag.Pagination.SetTarget("#divInput").Render()</div>
</div>